!function o(a,i,d){function r(t,e){if(!i[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(s)return s(t,!0);throw(n=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",n}n=i[t]={exports:{}},a[t][0].call(n.exports,function(e){return r(a[t][1][e]||e)},n,n.exports,o,a,i,d)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<d.length;e++)r(d[e]);return r}({1:[function(e,t,n){$(document).ready(function(){var i,d;"undefined"!=typeof Chart&&(Chart.defaults.global.defaultFontFamily='-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif',Chart.defaults.global.defaultFontColor="#292b2c",i=document.getElementById("myAreaChart"),d={1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dev"},Ajax.get(AEnvironment.ANALYTICS_VISITORS_URL.replace("{{days}}",13).replace("{{authtoken}}",getAuthToken()),function(e){e=JSON.parse(e).data,console.log("analytics visitors",e);var t,n=[],o=[],a=0;for(t in e)e.hasOwnProperty(t)&&(n.push(d[t.split("/")[1]]+" "+t.split("/")[2]),o.push(e[t]),a<e[t]&&(a=e[t]));a+=10-a%10;new Chart(i,{type:"line",data:{labels:n,datasets:[{label:"Visitors",lineTension:.3,backgroundColor:"rgba(2,117,216,0.2)",borderColor:"rgba(2,117,216,1)",pointRadius:5,pointBackgroundColor:"rgba(2,117,216,1)",pointBorderColor:"rgba(255,255,255,0.8)",pointHoverRadius:5,pointHoverBackgroundColor:"rgba(2,117,216,1)",pointHitRadius:50,pointBorderWidth:2,data:o}]},options:{scales:{xAxes:[{time:{unit:"date"},gridLines:{display:!1},ticks:{maxTicksLimit:7}}],yAxes:[{ticks:{min:0,max:a,maxTicksLimit:5},gridLines:{color:"rgba(0, 0, 0, .125)"}}]},legend:{display:!1}}})},function(e){e=JSON.parse(e),showToastMessage({title:"Could not load analytics visitors data!",body:e.message||"Something went wrong!"})}))})},{}],2:[function(e,t,n){$(document).ready(function(){var d;"undefined"!=typeof Chart&&(Chart.defaults.global.defaultFontFamily='-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif',Chart.defaults.global.defaultFontColor="#292b2c",d={1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dev"},Ajax.get(AEnvironment.ANALYTICS_ACTIVITY_URL.replace("{{days}}",13).replace("{{authtoken}}",getAuthToken()),function(e){e=JSON.parse(e).data,console.log("analytics activity",e);var t,n=[],o=[],a=0;for(t in e)e.hasOwnProperty(t)&&(n.push(d[t.split("/")[1]]+" "+t.split("/")[2]),o.push(e[t]),a<e[t]&&(a=e[t]));a+=10-a%10;var i=document.getElementById("myBarChart");new Chart(i,{type:"bar",data:{labels:n,datasets:[{label:"Activity",backgroundColor:"rgba(2,117,216,1)",borderColor:"rgba(2,117,216,1)",data:o}]},options:{scales:{xAxes:[{time:{unit:"month"},gridLines:{display:!1},ticks:{maxTicksLimit:6}}],yAxes:[{ticks:{min:0,max:a,maxTicksLimit:5},gridLines:{display:!0}}]},legend:{display:!1}}})},function(e){e=JSON.parse(e),showToastMessage({title:"Could not load analytics activity data!",body:e.message||"Something went wrong!"})}))})},{}],3:[function(e,t,n){$(document).ready(function(){})},{}],4:[function(e,t,n){"use strict";var f=function(t){return null==t&&(t={}),null==t.errorTitle&&(t.errorTitle="Error occured"),null==t.errorMsg&&(t.errorMsg="Something went wrong"),null==t.showToast&&(t.showToast=!0),function(e){e=JSON.parse(e),console.warn(e),t.showToast&&b({title:t.errorTitle,body:e.message||t.errorMsg})}};window.getErrorFnc=f,"adminconfigure"!=currentPage&&Ajax.get(AEnvironment.API_CONFIG_IS,function(e){(e=JSON.parse(e)).isConfigured||(window.location.href="/admin/configure")},f({errorTitle:"Error while validating configuration"}));var o=Ajax.get("/admin/templates/itemlist.html"),h=Ajax.get("/admin/templates/sidenav.html"),g=Ajax.get("/admin/templates/topnav.html");window.getItemTemplateProm=o,window.getAdminNavTemplateProm=h,window.getAdminTopNavTemplateProm=g;function w(){return localStorage.getItem("usersession")}window.getAuthToken=w;var v,a=0,b=function(e){a++,$(".toast-parent").append('\n  <div id="dynamic-toast-'+a+'" class="toast" role="alert"\n    aria-live="assertive" aria-atomic="true" style="min-width: 200px;">\n    <div class="toast-header">\n      <strong class="mr-auto">'+e.title+'</strong> &nbsp;&nbsp;&nbsp;\n      <small class="text-muted">just now</small>\n      <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">\n        <span aria-hidden="true">&times;</span>\n      </button>\n    </div>\n    <div class="toast-body">\n      '+e.body+"\n    </div>\n  </div>\n  "),$("#dynamic-toast-"+a).toast({delay:2e3}),$("#dynamic-toast-"+a).toast("show")};window.showToastMessage=b,window.currentItems=[];$(document).ready(function(){window.user={};function t(){return Ajax.post(AEnvironment.LOGOUT_URL,{usersessionid:w()},function(e){console.log("logout",e),e=JSON.parse(e),localStorage.removeItem("usersession"),window.location.href="/admin/login"},function(e){e=JSON.parse(e),b({title:"Could not log out properly!",body:e.message||"Something went wrong! but logging you out none the less"}),localStorage.removeItem("usersession"),window.location.href="/admin/login"}),!1}var n={};h.then(function(e){$(".admin-main-nav").html(e);var t=window.location.href;$("#layoutSidenav_nav .sb-sidenav a.nav-link").each(function(){this.href===t&&$(this).addClass("active")})},f()),g.then(function(e){$("nav.navbar").html(e),$("#sidebarToggle").click(function(){$("body").toggleClass("sb-sidenav-toggled")}),$(".logout-btn").click(t)},f()),"adminsettings"==currentPage&&($(".btn-sub-settings").click(function(e){var t,n={googleAdClient:$("#inputGoogleAdClient").val(),googleAnalytics:$("#inputGoogleAnalytics").val(),msValidator:$("#inputMSValidator").val(),defMetaDesc:$("#inputDefMetaDesc").val(),defMetaKey:$("#inputDefMetaKey").val(),lang:$("input[name=gridLang]:checked").val()};for(t in n)n.hasOwnProperty(t)&&(n[t]||0==n[t]||delete n[t]);return n.authtoken=w(),console.log("reqData for admin settings",n),Ajax.post(AEnvironment.ADMIN_SETTINGS,n).then(json).then(log),!1}),Ajax.get(AEnvironment.ADMIN_SETTINGS).then(json).then(function(e){$("#inputGoogleAdClient").val(e.googleAdClient),$("#inputGoogleAnalytics").val(e.googleAnalytics),$("#inputMSValidator").val(e.msValidator),$("#inputDefMetaDesc").val(e.defMetaDesc),$("#inputDefMetaKey").val(e.defMetaKey),$("input[name=gridLang][value="+e.lang+"]").prop("checked",!0)}));var o=function(){Ajax.post(AEnvironment.API_URL+"/admin/collection",{page:1,max:100,find:{},collectionName:"tracker",sort:{epochtime:-1}},function(e){e=JSON.parse(e),console.log("collection",e),$("#dataTable thead, #dataTable tfoot").html("\n      <tr>\n        <th>Session ID</th>\n        <th>Date</th>\n        <th>Time</th>\n        <th>Type</th>\n        <th>URL</th>\n        <th>Epoch Time</th>\n        <th>Browser</th>\n        <th>IP Address</th>\n      </tr>\n      ");for(var t="",n=0;n<e.data.length;n++)t+="\n        <tr>\n          <td>"+e.data[n].sessionid+"</td>\n          <td>"+new Date(1e3*e.data[n].epochtime).toLocaleDateString()+"</td>\n          <td>"+new Date(1e3*e.data[n].epochtime).toLocaleTimeString()+"</td>\n          <td>"+e.data[n].type+"</td>\n          <td>"+e.data[n].url+"</td>\n          <td>"+e.data[n].epochtime+"</td>\n          <td>"+e.data[n].browser+"</td>\n          <td>"+e.data[n].ip+"</td>\n        </tr>\n        ";$("#dataTable tbody").html(t),$("#dataTable").DataTable()},function(e){e=JSON.parse(e),b({title:"Could not load tracker data!",body:e.message||"Something went wrong!"})})},a=function(){Ajax.post(AEnvironment.API_URL+"/admin/collection",{page:1,max:100,find:{},collectionName:"contactus"},function(e){e=JSON.parse(e),console.log("collection",e),$("#dataTable thead, #dataTable tfoot").html("\n      <tr>\n        <th>First</th>\n        <th>Last</th>\n        <th>Email</th>\n        <th>Subject</th>\n        <th>Message</th>\n        <th>IP Address</th>\n        <th>Created date</th>\n        <th>Session ID</th>\n      </tr>\n      ");for(var t="",n=0;n<e.data.length;n++)t+="\n        <tr>\n          <td>"+e.data[n].fName+"</td>\n          <td>"+e.data[n].lName+"</td>\n          <td>"+e.data[n].email+"</td>\n          <td>"+e.data[n].subject+"</td>\n          <td>"+e.data[n].message+"</td>\n          <td>"+e.data[n].ip+"</td>\n          <td>"+e.data[n].cDate+"</td>\n          <td>"+e.data[n].cmsid+"</td>\n        </tr>\n        ";$("#dataTable tbody").html(t),$("#dataTable").DataTable()},function(e){e=JSON.parse(e),b({title:"Could not load contact us data!",body:e.message||"Something went wrong!"})})},i=function(){Ajax.post(AEnvironment.API_URL+"/admin/collection",{page:1,max:100,find:{},collectionName:"newsletter",sort:{createdepochtime:-1}},function(e){e=JSON.parse(e),console.log("collection",e),$("#dataTable thead, #dataTable tfoot").html("\n      <tr>\n        <th>Email</th>\n        <th>Is Active</th>\n        <th>Session ID</th>\n        <th>Date subscribed</th>\n        <th>IP</th>\n      </tr>\n      ");for(var t="",n=0;n<e.data.length;n++)t+="\n        <tr>\n          <td>"+e.data[n].email+"</td>\n          <td>"+e.data[n].isactive+"</td>\n          <td>"+e.data[n].sessionid+"</td>\n          <td>"+new Date(1e3*e.data[n].createdepochtime).toLocaleString()+"</td>\n          <td>"+e.data[n].ip+"</td>\n        </tr>\n        ";$("#dataTable tbody").html(t),$("#dataTable").DataTable()},function(e){e=JSON.parse(e),b({title:"Could not load news letter data!",body:e.message||"Something went wrong!"})})},d=function(){Ajax.post(AEnvironment.API_URL+"/admin/collection",{page:1,max:100,find:{},collectionName:"logs",sort:{createdtime:-1}},function(e){e=JSON.parse(e),console.log("collection",e),$("#dataTable thead, #dataTable tfoot").html("\n      <tr>\n        <th>Log Message</th>\n        <th>Log Stacktrace</th>\n        <th>Date</th>\n        <th>Time</th>\n        <th>Epoch Time</th>\n        <th>Log Type</th>\n        <th>Log Severity</th>\n      </tr>\n      ");for(var t="",n=0;n<e.data.length;n++)t+="\n        <tr>\n          <td>"+e.data[n].logmessage+"</td>\n          <td>"+e.data[n].logstack+"</td>\n          <td>"+new Date(1e3*e.data[n].createdtime).toLocaleDateString()+"</td>\n          <td>"+new Date(1e3*e.data[n].createdtime).toLocaleTimeString()+"</td>\n          <td>"+e.data[n].createdtime+"</td>\n          <td>"+e.data[n].type+"</td>\n          <td>"+e.data[n].severity+"</td>\n        </tr>\n        ";$("#dataTable tbody").html(t),$("#dataTable").DataTable()},function(e){e=JSON.parse(e),b({title:"Could not load news letter data!",body:e.message||"Something went wrong!"})})},r=function(){Ajax.post(AEnvironment.API_URL+"/admin/collection",{page:1,max:100,find:{},collectionName:"resourcereview",sort:{createtime:-1}},function(e){e=JSON.parse(e),console.log("collection",e),$("#dataTable thead, #dataTable tfoot").html("\n      <tr>\n        <th>Full Name</th>\n        <th>Email</th>\n        <th>Visible to public</th>\n        <th>Product Name</th>\n        <th>Date</th>\n        <th>Time</th>\n        <th>Epoch Time</th>\n        <th>Session Id</th>\n      </tr>\n      ");for(var t,n,o="",a=0;a<e.data.length;a++)e.data[a].isActive&&(t=function(e){if(v&&v.products&&v.products.length)for(var t=0;t<v.products.length;t++)if(v.products[t].id==e)return v.products[t]}(e.data[a].resourceid),n=e.data[a].resourceid,t&&(n=t.title),o+="\n        <tr>\n          <td>"+e.data[a].fullname+"</td>\n          <td>"+e.data[a].email+"</td>\n          <td>"+e.data[a].isApproved+"</td>\n          <td>"+n+"</td>\n          <td>"+new Date(1e3*e.data[a].createtime).toLocaleDateString()+"</td>\n          <td>"+new Date(1e3*e.data[a].createtime).toLocaleTimeString()+"</td>\n          <td>"+e.data[a].createtime+"</td>\n          <td>"+e.data[a].sessionid+"</td>\n        </tr>\n        ");$("#dataTable tbody").html(o),$("#dataTable").DataTable()},function(e){e=JSON.parse(e),b({title:"Could not load news letter data!",body:e.message||"Something went wrong!"})})},s=function(){$(".total-visitors").html(n.totalPageViews),$(".unique-visitors").html(n.totalUniqueVisits),$(".contact-submit").html(n.totalContactUsSubmitted),$(".newsletter-subs").html(n.totalNewsLetterSubscribed),$(".top-browser").html(n.hotBrowser.name+" with "+n.hotBrowser.count+" page view(s)"),$(".top-visitor").html(n.hotIP.name+" with "+n.hotIP.count+" page view(s)"),$(".top-page").html(n.hotURL.name+" was visited "+n.hotURL.count+"x time(s)"),$(".top-page-link").attr("href",n.hotURL.name)};if(-1==["adminlogin","adminregister","adminforgotpassword","adminresetpassword","adminconfigure"].indexOf(currentPage)&&Ajax.post(AEnvironment.SESSION_CHECK_URL,{usersessionid:w()},function(e){e=JSON.parse(e),console.log(e),user=e.user,$(".ausername").html(window.user.fName+" "+window.user.lName),"admindashboard"==currentPage&&Ajax.get(AEnvironment.ANALYTICS_SUMMARY_URL.replace("{{authtoken}}",w()),function(e){e=JSON.parse(e),console.log("analytics",e),n=e.data,s()},function(e){e=JSON.parse(e),b({title:"Could not load analytics data!",body:e.message||"Something went wrong!"})}),"admincontact"==currentPage?a():"adminnewsletter"==currentPage?i():"admindashboard"==currentPage?o():"adminlogs"==currentPage?d():"adminreviews"==currentPage&&new Promise(function(t,e){Ajax.get("/products/data/all.json",function(e){e=JSON.parse(e),t(v=e)},e)}).then(function(e){return r(),e},function(e){r()}).catch(function(e){r()})},function(e){e=JSON.parse(e),b({title:"Authentication error!",body:e.message||"Something went wrong!"}),window.location.href="/admin/login"}),$(".register-btn").click(function(e){return Ajax.post(AEnvironment.REGISTER_URL,{fName:$("#inputFirstName").val(),lName:$("#inputLastName").val(),email:$("#inputEmailAddress").val(),password:$("#inputPassword").val()},function(e){console.log("register",e),alert("Registered successfully, Now you may login"),window.location.href="/admin/login"},function(e){e=JSON.parse(e),b({title:"Could not register!",body:e.message||"Something went wrong!"})}),!1}),$(".logout-btn").click(t),$(".login-btn").click(function(e){return Ajax.post(AEnvironment.LOGIN_URL,{email:$("#inputEmailAddress").val(),password:$("#inputPassword").val()},function(e){console.log("login",e),e=JSON.parse(e),localStorage.setItem("usersession",e.data.sessionid),window.location.href="/admin"},function(e){e=JSON.parse(e),b({title:"Could not log in!",body:e.message||"Something went wrong!"})}),!1}),$(".reset-pass-btn").click(function(e){return Ajax.post(AEnvironment.FORGOT_PASSWORD_URL,{email:$("#inputEmailAddress").val()},function(e){e=JSON.parse(e),console.log("done",e),b({title:"Done!",body:"An email was sent to "+$("#inputEmailAddress").val()})},function(e){e=JSON.parse(e),b({title:"Error!",body:e.message||"Something went wrong!"})}),!1}),"adminresetpassword"==currentPage){var l=function(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}("resetid");if(!l)return b({title:"Invalid link!",body:"Invalid or broken link"}),void(window.location.href="/admin/login");$(".reset-pass-go-btn").click(function(e){return $("#inputPassword").val()==$("#inputConfirmPassword").val()?(Ajax.post(AEnvironment.RESET_PASSWORD_URL,{newpass:$("#inputPassword").val(),resetid:l},function(e){e=JSON.parse(e),console.log("done",e),b({title:"Done!",body:"Your password has been reset, login with your new password to continue to CMS One"}),setTimeout(function(){window.location.href="/admin/login"},2e3)},function(e){e=JSON.parse(e),b({title:"Error!",body:e.message||"Something went wrong!"})}),!1):void b({title:"Invalid passwords!",body:"Please enter matching passwords"})})}$(".config-btn").click(function(e){var n="true"==$("input[name=www]:checked").val(),o="true"==$("input[name=https]:checked").val(),a=$("#inputSiteName").val(),i=$("#inputSiteURL").val(),d=$("#inputAPIUrl").val(),r=$("#inputAuthKey").val();if(a&&i&&d&&r){var t=new Promise(function(t,e){Ajax.post(AEnvironment.API_CONFIG,{sitename:a,frontendurl:i,apiurl:d,haswww:n,isHttps:o,authkey:r},function(e){e=JSON.parse(e),console.log(e),t(e)},e)});return Promise.all([t]).then(function(){b({title:"Success!",body:"Successfully configured site data"}),setTimeout(function(){window.location.href="/admin/login"},2e3)},f({errorTitle:"Could not configure site"})),!1}f({errorTitle:"Cannot configure site",errorMsg:"Please fill all the details"})("{}")});var e,c,m,u;$("#inputSiteURL").val(window.location.host),$("#inputAPIUrl").val(AEnvironment.API_URL.replace("//",""));function p(){u=$("#inputAPIUrl").val(),m=$("#inputSiteURL").val(),e="true"==$("input[name=www]:checked").val(),c="true"==$("input[name=https]:checked").val(),$("#front-url").html((c?"https://":"http://")+(e?"www.":"")+m),$("#back-url").html((c?"https://":"http://")+u),setTimeout(function(){$("#front-url").html((c?"https://":"http://")+(e?"www.":"")+m),$("#back-url").html((c?"https://":"http://")+u)},50)}$("input[name=www], input[name=https], #inputAPIUrl, #inputSiteURL").on("change keydown keyup keypress",p),p()})},{}],5:[function(e,t,n){"use strict";var o=window.AEnvironment||{};o.ADMIN_COLELCTION_URL=o.API_URL+"/admin/collection",o.ADMIN_COLELCTION_DISTINCT_URL=o.API_URL+"/admin/collection/dist",o.SESSION_CHECK_URL=o.API_URL+"/admin/sessioncheck",o.LOGIN_URL=o.API_URL+"/admin/login",o.REGISTER_URL=o.API_URL+"/admin/register",o.LOGOUT_URL=o.API_URL+"/admin/logout",o.FORGOT_PASSWORD_URL=o.API_URL+"/admin/forgotpassword",o.VALIDATE_PASS_RESET_URL=o.API_URL+"/admin/validateresetrequest",o.RESET_PASSWORD_URL=o.API_URL+"/admin/resetpassword",o.ANALYTICS_SUMMARY_URL=o.API_URL+"/analytics/summary/{{authtoken}}",o.ANALYTICS_SESSION_DETAILS_URL=o.API_URL+"/analytics/sessiondetails",o.ANALYTICS_VISITORS_URL=o.API_URL+"/analytics/visitorsfordays/{{days}}/{{authtoken}}",o.ANALYTICS_ACTIVITY_URL=o.API_URL+"/analytics/activityfordays/{{days}}/{{authtoken}}",o.REVIEW_URL=o.API_URL+"/review",o.API_CONFIG_IS=o.API_URL+"/isconfigured",o.API_CONFIG=o.API_URL+"/siteinfo/configure",o.ADMIN_SETTINGS=o.API_URL+"/siteinfo/settings",o.CONFIG_IS=o.CURRENTHOST_URL+"/isconfigured",o.CONFIG=o.CURRENTHOST_URL+"/configure",o.CONTENT_FOLDERS=o.API_URL+"/contentfolder/site/{{authtoken}}",o.CONTENT_FOLDERS_BASE=o.API_URL+"/contentfolder",o.CONTENT_ITEM=o.API_URL+"/contentitem",o.CONTENT_ITEM_BY_FOLDER=o.API_URL+"/contentitem/folderid/{{folderid}}/{{authtoken}}",o.MENU_FOLDER_SITE=o.API_URL+"/menufolder/site/{{authtoken}}",o.MENU_FOLDER=o.API_URL+"/menufolder",o.PAGE=o.API_URL+"/page",o.PAGE_BY_FOLDER=o.API_URL+"/page/folderid/{{folderid}}/{{authtoken}}",o.PAGE_CONTENT=o.API_URL+"/pagecontent",o.PAGE_CONTENT_BY_PAGE=o.API_URL+"/pagecontent/page/{{pageid}}/{{authtoken}}"},{}],6:[function(e,t,n){"use strict";var o=function(){function r(e,t,n){return e.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),n)}var t={},e=0;window.replaceAll=r;function n(e){null==e&&(e={}),Object.assign(this,t.Model.defaults(),e)}n.prototype.getAttrByPropId=function(e){for(var t=0;t<this.elements.length;t++)if(this.elements[t].propId==e)return this.elements[t]},n.prototype.setPropValue=function(e,t){for(var n=0;n<this.elements.length;n++)if(this.elements[n].propId==e){this.elements[n].value=t;break}},n.prototype.toJSON=function(){for(var e={},t=0;t<this.elements.length;t++)e[this.elements[t].propId]=this.elements[t].value;return e},n.prototype.validate=function(){for(var e=0;e<this.elements.length;e++){var t=this.elements[e];if("function"==typeof t.validate)if(!t.validate(t.value))return!1;if(!0===t.isRequired&&""==t.value)return!1}return!0},n.defaults=function(){return{elements:[],buttons:[]}},t.Model=n;function s(e){null==e&&(e={}),Object.assign(this,t.View.defaults(),e),this._boundFncs=[]}return s.prototype.render=function(){this.$el.html(""),this.$el.attr("id",this.id),this.$el.addClass(this.className);for(var e=0;e<this.model.elements.length;e++){var t=this.model.elements[e],n=s.htmlTpls[t.inputType];n=r(n,"{{propName}}",t.propName),n=r(n,"{{formId}}",this.id),n=r(n,"{{propId}}",t.propId||e);var o=$(n);if("radio"==t.inputType){for(j=0;j<t.options.length;j++){var a=t.options[j],i=r(s.htmlTpls["radio-item"],"{{formId}}",this.id),i=r(i,"{{propId}}",t.propId||e);i=r(i,"{{optionId}}",j),i=r(i,"{{valueLabel}}",a.valueLabel),i=r(i,"{{value}}",a.value),o.append(i)}o.find("input[name=custom-form-radio-"+this.id+"-"+t.propId||e+"][value="+a.value+"]").prop("checked",!0),this.$el.append(o)}else"text"==t.inputType?o.find(".custom-inputtext").val(t.value):"textarea"==t.inputType&&o.find(".custom-textarea").val(t.value),this.$el.append(o)}this.$el.append('<div class="button-container"></div>');for(e=0;e<this.model.buttons.length;e++){var d=this.model.buttons[e],n=s.htmlTpls.btn;n=r(n,"{{btnClassName}}",d.btnClassName),n=r(n,"{{btnType}}",d.btnType),n=r(n,"{{buttonId}}",d.buttonId),n=r(n,"{{label}}",d.label),n=r(n,"{{iconClassName}}",d.iconClassName);o=$(n);d.iconClassName||o.find(".custom-btn-icon").hide(),this.$el.find(".button-container").append(o),this.$el.find(".button-container").append('<span class="btn-gap">&nbsp;</span>')}return this.removeEventListeners(),this.addEventListeners(),this},s.prototype.addEventListeners=function(){var n=this;this.$el.find(".custom-inputtext, .custom-textarea").bind("change keydown keyup",function(e){var t=$(e.target).data("id"),e=$(e.target).val();n.model.getAttrByPropId(t).value=e}),this.$el.find(".custom-inputradio").bind("change keydown keyup",function(e){var t=$(e.target).data("id"),e=$("input[name=custom-form-radio-"+n.id+"-"+t+"]:checked").val();n.model.getAttrByPropId(t).value=e})},s.prototype.removeEventListeners=function(){this.$el.find(".custom-inputtext, .custom-textarea").unbind("change keydown keyup"),this.$el.find(".custom-inputradio").unbind("change keydown keyup")},s.prototype.bind=s.prototype.on=function(e,t,n){var o,a,i,d=this;"submit"===e&&(n?(a=t.bind(n),i=function(e){if(e.preventDefault(),d.model.validate())return a(d.model.toJSON(),d,e)},this._boundFncs.push({fnc:i,type:e,context:n}),this.$el.bind("submit",i)):this.$el.bind("submit",function(e){if(e.preventDefault(),d.model.validate())return t(d.model.toJSON(),d,e)})),-1!=e.indexOf("click<")&&(o=/(click<)(.*)(>)/.exec(e)[2],n?(a=t.bind(n),i=function(e){return a(d.model.toJSON(),d,e)},this._boundFncs.push({fnc:i,type:e,context:n}),this.$el.find("#custom-btn-"+o).bind("click",i)):this.$el.find("#custom-btn-"+o).bind("click",function(e){return t(d.model.toJSON(),d,e)}))},s.prototype.unbind=s.prototype.off=function(e,t){if(t){for(var n=0;n<this._boundFncs.length;n++)if(this._boundFncs[n].type==e&&this._boundFncs[n].context==t){a=this._boundFncs[n].fnc;break}this.$el.unbind(e,a)}else this.$el.unbind(e);if(-1!=e.indexOf("click<")){var o=/(click<)(.*)(>)/.exec(e)[2];if(t){for(var a,i=-1,n=0;n<this._boundFncs.length;n++)if(this._boundFncs[n].type==e&&this._boundFncs[n].context==t){a=this._boundFncs[n].fnc,i=n;break}this.$el.find("#custom-btn-"+o).unbind("click",a),-1!=i&&this._boundFncs.splice(i,1)}else this.$el.find("#custom-btn-"+o).unbind("click")}},s.htmlTpls={},s._saveTpl=function(e,t){s.htmlTpls[e]=t},s.templates={textarea:Ajax.get("/admin/templates/bootstrap-forms-textarea.html").then(s._saveTpl.bind(s,"textarea")),text:Ajax.get("/admin/templates/bootstrap-forms-text.html").then(s._saveTpl.bind(s,"text")),radio:Ajax.get("/admin/templates/bootstrap-forms-radio.html").then(s._saveTpl.bind(s,"radio")),radioItem:Ajax.get("/admin/templates/bootstrap-forms-radio-item.html").then(s._saveTpl.bind(s,"radio-item")),btn:Ajax.get("/admin/templates/bootstrap-forms-btn.html").then(s._saveTpl.bind(s,"btn"))},s.defaults=function(){return{model:new n,id:"custom-form-"+e++,el:"",$el:$("<form></form>"),className:"custom-form"}},t.View=s,t}();window.BForms=o},{}],7:[function(e,t,n){"use strict";$(document).ready(function(){var n,a,o,i,e;"admincontent"==currentPage&&(a="",o=function e(t,n,o){if(n.id==o)return t+"/"+n.name;for(var a=t+"/"+n.name,i=0;i<n.nodes.length;i++)if(t=e(a,n.nodes[i],o))return t;return null},i=function(){Ajax.get(AEnvironment.CONTENT_FOLDERS.replace("{{authtoken}}",getAuthToken()),function(e){e=function e(t){t.text=t.name;for(var n=0;n<t.nodes.length;n++)t.nodes[n]=e(t.nodes[n]);return t}(e=JSON.parse(e)),console.log("cont folders",e),n=e,$(".admin-tree").treeview("remove"),$(".admin-tree").treeview({data:[e],expandIcon:"fa fa-plus",collapseIcon:"fa fa-minus",emptyIcon:"fa",nodeIcon:"",showBorder:!0,showIcon:!0})},getErrorFnc({errorTitle:"Error occured while fetching content folders"}))},window.fetchItemsAndDisplay=function(){var e,t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid"));e=t.id,new Promise(function(t,n){Ajax.get(AEnvironment.CONTENT_ITEM_BY_FOLDER.replace("{{folderid}}",e).replace("{{authtoken}}",getAuthToken()),function(e){e=JSON.parse(e),console.log("fetch content items",e),t(e)},function(e){n(e),getErrorFnc({errorTitle:"Error fetching content for this folder",errorMsg:"Please try again later"})(e)})}).then(function(i){0==(window.currentItems=i).length?$(".main-item-msg").html('<p class="">No items available in this folder</p>'):$(".main-item-msg").html('<p class=""></p>'),getItemTemplateProm.then(function(e){for(var t="",n=0;n<i.length;n++){var o=e,a=i[n],o=replaceAll(o,"{{{itemtitle}}}",a.name);o=replaceAll(o,"{{{itemdesc}}}",a.desc),o=replaceAll(o,"{{{itemtype}}}",ContentItemTypesDisplayTitles[ContentItemTypes[a.type]]),o=replaceAll(o,"{{{itemlasteditedtime}}}",timeSince(new Date(1e3*a.lastmodifiedtime))+" ago"),t+=replaceAll(o,"{{{itemid}}}",a.id)}$(".main-items-area .list-group").html(t),$(".main-items-area .list-group .main-items-adv-edit-btn").hide(),$(".main-items-area .list-group .main-items-select-btn").hide(),window.bindItemEditEvents()},getErrorFnc())})},e=function(){$(".admin-tree-parent").click(function(e){var t;$(e.target).hasClass("list-group-item")&&null!=$(".node-selected").data("nodeid")&&(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),window.fetchItemsAndDisplay(),e=t.id,(e=(t=o("~",n,e)).split("/"))[e.length-1]="<strong>"+e[e.length-1]+"</strong>",t=e.join("/"),$(".folder-path").html(t))})},i(),e(),$("#addEditFolderModal").on("show.bs.modal",function(e){var t,n,o;0!=$(".node-selected").length?("add"==(t=$(e.relatedTarget).data("purpose"))?n="Add new content folder":"edit"==t&&(n="Rename content folder"),(e=$(this)).find(".modal-title").text(n),"add"==t?(o=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),e.find(".parent-folder-para").show(),e.find(".parent-folder-name").text(o.text)):"edit"==t&&(o=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),e.find("#folder-name").val(o.text),e.find(".parent-folder-para").hide()),a=t):$("#addEditFolderModal").modal("hide")}),$("#deleteFolderModal").on("show.bs.modal",function(e){var t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid"));$("#deleteFolderModal").find(".delete-fldr-title").text(t.text)}),$(".tree-add-btn").click(function(e){if(0==$(".node-selected").length)return e.stopPropagation(),e.preventDefault(),getErrorFnc({errorTitle:"Cannot add a folder",errorMsg:"Please select a folder to add to"})("{}"),!1}),$(".tree-edit-btn").click(function(e){if(0==$(".node-selected").length)return e.stopPropagation(),e.preventDefault(),getErrorFnc({errorTitle:"Cannot rename a folder",errorMsg:"Please select a folder to rename"})("{}"),!1}),$(".tree-remove-btn").click(function(e){0!=$(".node-selected").length?$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")).folderid!=UUID_NIL?$("#deleteFolderModal").modal("show"):showToastMessage({title:"Cannot delete a folder",body:"You cannot delete your core parent folder"}):showToastMessage({title:"Cannot delete a folder",body:"Please select a folder to delete"})}),$(".add-edit-save-btn").click(function(e){var t,n=$("#folder-name").val(),o=$("#folder-desc").val();n?(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),o={name:n,desc:o,authtoken:getAuthToken()},"add"==a?(o.folderid=t.id,o.createdby=user.id):"edit"==a&&(o.folderid=t.folderid,o.id=t.id,o.lastmodifiedby=user.id),Ajax.put(AEnvironment.CONTENT_FOLDERS_BASE,o).then(json).then(function(e){console.log("put c folder",e),i(),$("#addEditFolderModal").modal("hide")},getErrorFnc({errorTitle:"Cannot add/edit content folder",errorMsg:"Cannot add/edit content folder, please try again later"}))):showToastMessage({title:"Please enter folder name",body:"folder name must be non empty"})}),$(".confirm-delete-fldr-btn").click(function(e){if(0==$(".node-selected").length)return showToastMessage({title:"Cannot delete a folder",body:"Please select a folder to delete"}),!1;var t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid"));Ajax.delete(AEnvironment.CONTENT_FOLDERS_BASE,{id:t.id,authtoken:getAuthToken(),folderid:t.folderid}).then(json).then(function(e){console.log("delete c folder",e),i(),$("#deleteFolderModal").modal("hide")},getErrorFnc())}))})},{}],8:[function(e,t,n){"use strict";var r=ACommon.EnumGenerator({PLAIN_TEXT:1,HTML:2,JSON:3,XML:4});window.ContentItemTypes=r;var s=ACommon.EnumGenerator({PLAIN_TEXT:"Plaintext",HTML:"HTML",JSON:"JSON",XML:"XML"});window.ContentItemTypesDisplayTitles=s,$(document).ready(function(){var n,e,d,o,a,t;"adminmenuspages"===currentPage&&(e=Ajax.get("/admin/templates/content-modal-select.html"),d=new BModal({headerText:"Select Content Item",body:"",size:BModal.SIZE.LARGE,buttons:[{label:"Cancel",buttonId:"content-cancel-btn",btnClassName:"secondary",btnType:"button",iconClassName:"",onClick:function(e,t){e.hide(),$(d).trigger("content-item-selection-cancelled",{modal:e,event:t})}}]}),o=function(){var e,t=d.$el.find(".content-folder-tree").treeview("getNode",d.$el.find(".node-selected").data("nodeid"));e=t.id,new Promise(function(t,n){Ajax.get(AEnvironment.CONTENT_ITEM_BY_FOLDER.replace("{{folderid}}",e).replace("{{authtoken}}",getAuthToken()),function(e){e=JSON.parse(e),console.log("fetch content items",e),t(e)},function(e){n(e),getErrorFnc({errorTitle:"Error fetching content for this folder",errorMsg:"Please try again later"})(e)})}).then(function(i){0==(window.currentItems=i).length?d.$el.find(".content-modal-item-msg").html('<p class="">No items available in this folder</p>'):d.$el.find(".content-modal-item-msg").html('<p class=""></p>'),getItemTemplateProm.then(function(e){for(var t="",n=0;n<i.length;n++){var o=e,a=i[n],o=replaceAll(o,"{{{itemtitle}}}",a.name);o=replaceAll(o,"{{{itemdesc}}}",a.desc),o=replaceAll(o,"{{{itemtype}}}",s[r[a.type]]),o=replaceAll(o,"{{{itemlasteditedtime}}}",timeSince(new Date(1e3*a.lastmodifiedtime))+" ago"),t+=replaceAll(o,"{{{itemid}}}",a.id)}d.$el.find(".content-modal-items-area .list-group").html(t),d.$el.find(".content-modal-items-area .list-group button").hide(),d.$el.find(".content-modal-items-area .list-group .main-items-select-btn").show(),d.$el.find(".content-modal-items-area .list-group .main-items-select-btn").click(function(e){var t=$(e.currentTarget).attr("data-itemid");$(d).trigger("content-item-selected",{modal:d,event:e,contentItemId:t})})},getErrorFnc())})},a=function e(t,n,o){if(n.id==o)return t+"/"+n.name;for(var a=t+"/"+n.name,i=0;i<n.nodes.length;i++)if(t=e(a,n.nodes[i],o))return t;return null},t=function(){d.$el.find(".content-modal-folder-tree-parent").click(function(e){var t;$(e.target).hasClass("list-group-item")&&null!=d.$el.find(".node-selected").data("nodeid")&&(t=d.$el.find(".content-folder-tree").treeview("getNode",d.$el.find(".node-selected").data("nodeid")),o(),e=t.id,(e=(t=a("~",n,e)).split("/"))[e.length-1]="<strong>"+e[e.length-1]+"</strong>",t=e.join("/"),d.$el.find(".content-modal-folder-path").html(t))})},(window.gl_contentModal=d).render().then(function(){$(".modal-parent-cont").append(d.$el),e.then(function(e){d.$el.find(".other-main-container").html(e),Ajax.get(AEnvironment.CONTENT_FOLDERS.replace("{{authtoken}}",getAuthToken()),function(e){e=function e(t){t.text=t.name;for(var n=0;n<t.nodes.length;n++)t.nodes[n]=e(t.nodes[n]);return t}(e=JSON.parse(e)),console.log("cont folders",e),n=e,d.$el.find(".content-folder-tree").treeview("remove"),d.$el.find(".content-folder-tree").treeview({data:[e],expandIcon:"fa fa-plus",collapseIcon:"fa fa-minus",emptyIcon:"fa",nodeIcon:"",showBorder:!0,showIcon:!0})},getErrorFnc()),t()})}))})},{}],9:[function(e,t,n){"use strict";var a=ACommon.EnumGenerator({PLAIN_TEXT:1,HTML:2,JSON:3,XML:4});window.ContentItemTypes=a;var i,d=ACommon.EnumGenerator({PLAIN_TEXT:"Plaintext",HTML:"HTML",JSON:"JSON",XML:"XML"});window.ContentItemTypesDisplayTitles=d;function r(e){var t;null==e&&(e=i);for(var n=0;n<window.currentItems.length;n++){var o=window.currentItems[n];if(o.id==e){t=o;break}}return t}$(document).ready(function(){var o;"string"==typeof currentPage&&"admincontent"==currentPage&&(o="",window.bindItemEditEvents=function(){$(".main-items-edit-btn").click(function(e){i=$(e.currentTarget).attr("data-itemid");e=r(i);e?($("#addedit-item-type").val(d[a[e.type]]).attr("disabled",!0),$("#addedit-item-name").val(e.name),$("#addedit-item-desc").val(e.desc),$("#addedit-item-itemmain").val(e.contentstr),$(".parent-item-para").hide(),$("#addEditItemModal").modal("show"),o="edit"):showToastMessage({title:"And error occured",body:"Selected item cannot be found in list"})}),$(".main-items-remove-btn").click(function(e){i=$(e.currentTarget).attr("data-itemid");e=r(i);$("#deleteItemModal").find(".delete-item-title").text(e.name),$("#deleteItemModal").modal("show")})},$(".main-items-add-btn").click(function(e){var t;0!=$(".node-selected").length?(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),$("#addedit-item-type").val(""),$("#addedit-item-name").val(""),$("#addedit-item-desc").val(""),$("#addedit-item-itemmain").val(""),$(".parent-item-para").show(),$(".parent-item-name").text(t.text),$("#addedit-item-type").removeAttr("disabled"),$("#addEditItemModal").modal("show"),o="add"):showToastMessage({title:"Cannot insert item",body:"Please select a folder to add item to"})}),$(".add-edit-item-save-btn").click(function(e){var t,n;0!=$(".node-selected").length?(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),(n={}).authtoken=getAuthToken(),n.name=$("#addedit-item-name").val(),n.desc=$("#addedit-item-desc").val(),n.contentstr=$("#addedit-item-itemmain").val(),n.lastmodifiedby=window.user.id,"edit"==o?n.id=i:"add"==o&&(n.folderid=t.id,n.createdby=window.user.id,n.type=a[d[$("#addedit-item-type").val()]]),Ajax.put(AEnvironment.CONTENT_ITEM,n).then(json).then(function(e){console.log("Put c item",e),window.fetchItemsAndDisplay(),$("#addEditItemModal").modal("hide")},getErrorFnc())):showToastMessage({title:"Cannot insert item",body:"Please select a folder to add item to"})}),$(".confirm-delete-item-btn").click(function(e){return i?void Ajax.delete(AEnvironment.CONTENT_ITEM,{id:i,authtoken:getAuthToken(),lastmodifiedby:window.user.id}).then(json).then(function(e){console.log("delete c item",e),window.fetchItemsAndDisplay(),$("#deleteItemModal").modal("hide")},getErrorFnc()):(showToastMessage({title:"Cannot delete an item",body:"Item id not found, refresh to continue"}),!1)}))})},{}],10:[function(e,t,n){"use strict";e("./scripts"),e("../assets/demo/chart-area-demo"),e("../assets/demo/chart-bar-demo"),e("../assets/demo/datatables-demo"),e("../../js/common/ajax"),e("../../js/common/browser"),e("../../js/common/app"),e("./app"),e("./admin-main"),e("./content-folders"),e("./content-items"),e("./bootstrap-forms"),e("./../../packages/bootstrap-modal/js/bootstrap-modals"),e("./pagecontent-adv-modal"),e("./content-item-modal"),e("./menus-folders"),e("./pages-items")},{"../../js/common/ajax":15,"../../js/common/app":16,"../../js/common/browser":17,"../assets/demo/chart-area-demo":1,"../assets/demo/chart-bar-demo":2,"../assets/demo/datatables-demo":3,"./../../packages/bootstrap-modal/js/bootstrap-modals":18,"./admin-main":4,"./app":5,"./bootstrap-forms":6,"./content-folders":7,"./content-item-modal":8,"./content-items":9,"./menus-folders":11,"./pagecontent-adv-modal":12,"./pages-items":13,"./scripts":14}],11:[function(e,t,n){"use strict";function o(t){return function(e){$("#"+e).modal(t)}}var a,r,s={addEditFolderModal:Ajax.get("/admin/templates/add-edit-folder-modal.html"),addEditItemModal:Ajax.get("/admin/templates/add-edit-item-modal.html"),deleteFolderModal:Ajax.get("/admin/templates/delete-folder-modal.html"),deleteItemModal:Ajax.get("/admin/templates/delete-item-modal.html")},l={pageName:"adminmenuspages",contentByFolderURL:AEnvironment.PAGE_BY_FOLDER,siteFolderTreeURL:AEnvironment.MENU_FOLDER_SITE,folderDeleteURL:AEnvironment.MENU_FOLDER,folderPutURL:AEnvironment.MENU_FOLDER},c=o("show");o("hide");currentPage==l.pageName&&$(document).ready(function(){s.addEditFolderModal.then(function(e){$(".modal-parent-cont").append(e),$(".add-edit-save-btn").click(function(e){var t,n,o=$("#folder-name").val(),a=$("#folder-desc").val();o?(n=(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid"))).nodes.length+1,a={name:o,desc:a,authtoken:getAuthToken()},"add"==r?(a.folderid=t.id,a.createdby=user.id,a.displayOrder=n):"edit"==r&&(a.folderid=t.folderid,a.id=t.id,a.lastmodifiedby=user.id,a.displayOrder=t.displayOrder),Ajax.put(l.folderPutURL,a).then(json).then(function(e){console.log("put folder",e),d(),$("#addEditFolderModal").modal("hide")},getErrorFnc({errorTitle:"Cannot add/edit content folder",errorMsg:"Cannot add/edit content folder, please try again later"}))):showToastMessage({title:"Please enter folder name",body:"folder name must be non empty"})})}),s.addEditItemModal.then(function(e){$(".modal-parent-cont").append(e)}),s.deleteFolderModal.then(function(e){$(".modal-parent-cont").append(e)}),s.deleteItemModal.then(function(e){$(".modal-parent-cont").append(e)});function i(e,t,n){if(t.id==n)return e+"/"+t.name;for(var o=e+"/"+t.name,a=0;a<t.nodes.length;a++)if(e=i(o,t.nodes[a],n))return e;return null}function n(e){return i("~",a,e)}window.getFolderPathById=n;window.fetchItemsAndDisplay=function(){var e,t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid"));e=t.id,new Promise(function(t,n){Ajax.get(l.contentByFolderURL.replace("{{folderid}}",e).replace("{{authtoken}}",getAuthToken()),function(e){e=JSON.parse(e),console.log("fetch items",e),t(e)},function(e){n(e),getErrorFnc({errorTitle:"Error fetching pages for this folder",errorMsg:"Please try again later"})(e)})}).then(function(i){0==(window.currentItems=i).length?$(".main-item-msg").html('<p class="">No items available in this folder</p>'):$(".main-item-msg").html('<p class=""></p>'),getItemTemplateProm.then(function(e){for(var t="",n=0;n<i.length;n++){var o=e,a=i[n],o=replaceAll(o,"{{{itemtitle}}}",a.name);o=replaceAll(o,"{{{itemdesc}}}",a.desc),o=replaceAll(o,"{{{itemlasteditedtime}}}",timeSince(new Date(1e3*a.lastmodifiedtime))+" ago"),t+=replaceAll(o,"{{{itemid}}}",a.id)}$(".main-items-area .list-group").html(t),$(".main-items-area .list-group .item-type").hide(),$(".main-items-area .list-group .main-items-select-btn").hide(),window.bindItemEditEvents()},getErrorFnc())})};var d=function(){Ajax.get(l.siteFolderTreeURL.replace("{{authtoken}}",getAuthToken())).then(json).then(function(e){e=function e(t){t.text=t.name;for(var n=0;n<t.nodes.length;n++)t.nodes[n]=e(t.nodes[n]);return t}(e),console.log("folders",e),a=e,$(".admin-tree").treeview("remove"),$(".admin-tree").treeview({data:[e],expandIcon:"fa fa-plus",collapseIcon:"fa fa-minus",emptyIcon:"fa",nodeIcon:"",showBorder:!0,showIcon:!0})})};$(".tree-remove-btn").click(function(e){0!=$(".node-selected").length?$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")).folderid!=UUID_NIL?$("#deleteFolderModal").modal("show"):showToastMessage({title:"Cannot delete a folder",body:"You cannot delete your core parent folder"}):showToastMessage({title:"Cannot delete a folder",body:"Please select a folder to delete"})}),$(".tree-add-btn").click(function(){if(0==$(".node-selected").length)return $("#addEditFolderModal").modal("hide"),getErrorFnc({errorTitle:"Cannot add a folder",errorMsg:"Please select a folder to add to"})("{}"),!1;var e;(r="add")==r?e="Add new content folder":"edit"==r&&(e="Rename content folder");var t,n=$("#addEditFolderModal");n.find(".modal-title").text(e),"add"==r?(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),n.find(".parent-folder-para").show(),n.find(".parent-folder-name").text(t.text)):"edit"==r&&(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),n.find("#folder-name").val(t.text),n.find(".parent-folder-para").hide()),c("addEditFolderModal")}),$(".tree-edit-btn").click(function(e){return 0==$(".node-selected").length?(e.stopPropagation(),e.preventDefault(),getErrorFnc({errorTitle:"Cannot rename a folder",errorMsg:"Please select a folder to rename"})("{}"),!1):void(r="add")}),$(".confirm-delete-fldr-btn").click(function(e){if(0==$(".node-selected").length)return showToastMessage({title:"Cannot delete a folder",body:"Please select a folder to delete"}),!1;var t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid"));Ajax.delete(l.folderDeleteURL,{id:t.id,authtoken:getAuthToken(),folderid:t.folderid}).then(json).then(function(e){console.log("delete folder",e),d(),$("#deleteFolderModal").modal("hide")},getErrorFnc())}),d(),$(".admin-tree-parent").click(function(e){var t;$(e.target).hasClass("list-group-item")&&null!=$(".node-selected").data("nodeid")&&(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),window.fetchItemsAndDisplay(),(t=(e=n(t.id)).split("/"))[t.length-1]="<strong>"+t[t.length-1]+"</strong>",e=t.join("/"),$(".folder-path").html(e))})})},{}],12:[function(e,t,n){"use strict";$(document).ready(function(){var e=Ajax.get("/admin/templates/pagecontent-adv-modal.html"),d=new BModal({headerText:"Edit Page content for ",body:"<p>Here you can customize your page</p><p>As soon as you attach content items here items will be saved automatically</p>",size:BModal.SIZE.LARGE,buttons:[{label:"Done",buttonId:"page-content-done-btn",btnClassName:"secondary",btnType:"button",iconClassName:"",onClick:function(e){e.hide()}}]});(window.gl_pageContentAdvModal=d).render().then(function(){$(".modal-parent-cont").append(d.$el),e.then(function(e){d.$el.find(".other-main-container").html(e),d.$el.find(".page-content-modal-add-content").click(function(e){window.gl_contentModal.show()}),$(window.gl_contentModal).on("content-item-selected",function(e,t){console.log("content item selected",t.contentItemId);var n=1;d.attrs.pageContentList&&(n=d.attrs.pageContentList.length+1);n={authtoken:getAuthToken(),pageid:d.attrs.pageid,contentid:t.contentItemId,displayOrder:n};Ajax.put(AEnvironment.PAGE_CONTENT,n).then(json).then(function(e){window.gl_contentModal.hide()},getErrorFnc())})})});d.updatePageId=function(e){d.attrs.pageid=e,d.attrs.pageid&&Ajax.get(AEnvironment.PAGE_CONTENT_BY_PAGE.replace("{{pageid}}",d.attrs.pageid).replace("{{authtoken}}",getAuthToken())).then(json).then(function(i){console.log("page content",i),d.attrs.pageContentList=i,getItemTemplateProm.then(function(e){0==i.length&&d.$el.find(".page-content-modal-item-msg").html("No content added in this page yet");for(var t="",n=0;n<i.length;n++){var o=e,a=i[n],o=replaceAll(o,"{{{itemtitle}}}",a.name);o=replaceAll(o,"{{{itemdesc}}}",a.desc),o=replaceAll(o,"{{{itemlasteditedtime}}}",""),o=replaceAll(o,"{{{itemtype}}}",ContentItemTypesDisplayTitles[ContentItemTypes[a.type]]),o=replaceAll(o,"{{{itemid}}}",a.id),t+=replaceAll(o,"{{{mappingid}}}",a.mappingid)}d.$el.find(".page-content-modal-items-area .list-group").html(t),d.$el.find(".page-content-modal-items-area .list-group button").hide(),d.$el.find(".page-content-modal-items-area .list-group .main-items-remove-btn").show(),d.$el.find(".page-content-modal-items-area .list-group .main-items-remove-btn").click(function(e){$(d).trigger("page-content-item-removed",{modal:d,event:e});var t=$(e.currentTarget).attr("data-itemid"),t={id:$(e.currentTarget).attr("data-mappingid"),authtoken:getAuthToken(),pageid:d.attrs.pageid,contentid:t};Ajax.delete(AEnvironment.PAGE_CONTENT,t).then(json).then(function(e){console.log("page content deleted",e)},getErrorFnc())})},getErrorFnc())})}})},{}],13:[function(e,t,n){"use strict";function d(e){var t;null==e&&(e=r);for(var n=0;n<window.currentItems.length;n++){var o=window.currentItems[n];if(o.id==e){t=o;break}}return t}var r,s,l={pageName:"adminmenuspages",putURL:AEnvironment.PAGE,deleteURL:AEnvironment.PAGE,postURL:AEnvironment.PAGE};$(document).ready(function(){var a,i,n,t;"string"==typeof currentPage&&currentPage==l.pageName&&(a="",window.bindItemEditEvents=function(){$(".main-items-edit-btn").click(function(e){r=$(e.currentTarget).attr("data-itemid");var t=d(r);t?(e=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),s=e.id,e=window.getFolderPathById(e.id),i.body="<p>You are currently in "+e+"</p><p>Add basic details for your page</p>",a="edit",i.formView.model.setPropValue("pagename",t.name),i.formView.model.setPropValue("pagedesc",t.desc),i.formView.model.setPropValue("pageurl",t.urlfrdnlyname),i.formView.model.setPropValue("pageseokeywords",t.metaKeyword),i.formView.model.setPropValue("pageseodesc",t.metaDesc),i.formView.render(),n(),i.show()):showToastMessage({title:"And error occured",body:"Selected item cannot be found in list"})}),$(".main-items-remove-btn").click(function(e){r=$(e.currentTarget).attr("data-itemid");e=d(r);t.headerText="Are you sure you want to delete `"+e.name+"` page?",t.show()}),$(".main-items-adv-edit-btn").click(function(e){r=$(e.currentTarget).attr("data-itemid");e=d(r);window.gl_pageContentAdvModal.headerText="Edit Page content for <strong>"+e.name+"</strong>",window.gl_pageContentAdvModal.updatePageId(r),window.gl_pageContentAdvModal.show()})},$(".main-items-add-btn").click(function(e){var t;0!=$(".node-selected").length?(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),s=t.id,t=window.getFolderPathById(t.id),i.body="<p>You are currently in "+t+"</p><p>Add basic details for your page</p>",a="add",i.show()):showToastMessage({title:"Cannot insert item",body:"Please select a folder to add item to"})}),$(".add-edit-item-save-btn").click(function(e){var t,n;0!=$(".node-selected").length?(t=$(".admin-tree").treeview("getNode",$(".node-selected").data("nodeid")),(n={}).authtoken=getAuthToken(),n.name=$("#addedit-item-name").val(),n.desc=$("#addedit-item-desc").val(),n.lastmodifiedby=window.user.id,"edit"==a?n.id=r:"add"==a&&(n.folderid=t.id,n.createdby=window.user.id),Ajax.put(l.putURL,n).then(json).then(function(e){console.log("Put c item",e),window.fetchItemsAndDisplay(),$("#addEditItemModal").modal("hide")},getErrorFnc())):showToastMessage({title:"Cannot insert item",body:"Please select a folder to add item to"})}),$(".confirm-delete-item-btn").click(function(e){return r?void Ajax.delete(l.deleteURL,{id:r,authtoken:getAuthToken(),lastmodifiedby:window.user.id}).then(json).then(function(e){console.log("delete c item",e),window.fetchItemsAndDisplay(),$("#deleteItemModal").modal("hide")},getErrorFnc()):(showToastMessage({title:"Cannot delete an item",body:"Item id not found, refresh to continue"}),!1)}),i=new BModal({headerText:"Add a new page",body:"<p>You are currently in </p><p>Add basic details for your page</p>",size:BModal.SIZE.LARGE,formData:{elements:[{propName:"Page Name *",propId:"pagename",value:"",inputType:"text",isRequired:!0},{propName:"Desription",propId:"pagedesc",inputType:"textarea"},{propName:"Page URL * (index URL will be treated as default)",propId:"pageurl",value:"",inputType:"text",isRequired:!0},{propName:"SEO Meta Description *",propId:"pageseodesc",value:"",inputType:"textarea",isRequired:!0},{propName:"SEO Meta Keywords *",propId:"pageseokeywords",value:"",inputType:"text",isRequired:!0}],buttons:[{label:"Save",buttonId:"save-btn",btnClassName:"primary",btnType:"submit",iconClassName:"fas fa-save"},{label:"Cancel",buttonId:"cancel-btn",btnClassName:"default",btnType:"button",iconClassName:""}]}}),n=function(){i.formView.on("click<save-btn>",function(e,t,n){var o;n.preventDefault(),t.model.validate()?(1<(t=(n=window.getFolderPathById(s)).split("/Menu")).length&&(n=t[1]),1<(t=n.split("/Footer")).length&&(n=t[1]),console.log(n+"/"+e.pageurl),"add"==a?(o={authtoken:getAuthToken(),folderid:s,name:e.pagename,urlfrdnlyname:e.pageurl,completeurl:n+"/"+e.pageurl,desc:e.pagedesc,metaKeyword:e.pageseokeywords,metaDesc:e.pageseodesc},Ajax.put(l.putURL,o).then(json).then(function(e){console.log("Put page item",e),window.fetchItemsAndDisplay(),i.hide()},getErrorFnc())):"edit"==a&&(o={id:d(r).id,authtoken:getAuthToken(),name:e.pagename,urlfrdnlyname:e.pageurl,completeurl:n+"/"+e.pageurl,desc:e.pagedesc,metaKeyword:e.pageseokeywords,metaDesc:e.pageseodesc,lastmodifiedby:user.id},Ajax.post(l.postURL,o).then(json).then(function(e){console.log("Put page item",e),window.fetchItemsAndDisplay(),i.hide()},getErrorFnc()))):showToastMessage({title:"Cannot create/edit page",body:"Please fill all the inputs"})}),i.formView.on("click<cancel-btn>",function(e,t,n){i.hide()})},i.render().then(function(){$(".modal-parent-cont").append(i.$el),n()}),(t=new BModal({headerText:"Are you sure you want to delete this page?",body:"<p>You wont be able to recover once you delete</p>",buttons:[{label:"Delete",buttonId:"page-delete-btn",btnClassName:"danger",btnType:"submit",iconClassName:"fas fa-trash",onClick:function(t,e){e.preventDefault(),r?Ajax.delete(l.deleteURL,{id:r,authtoken:getAuthToken(),lastmodifiedby:window.user.id}).then(json).then(function(e){console.log("delete page item",e),window.fetchItemsAndDisplay(),t.hide()},getErrorFnc()):showToastMessage({title:"Something went wrong",body:"Please try again later or refresh the page"})}},{label:"Cancel",buttonId:"page-del-cancel-btn",btnClassName:"primary",btnType:"button",iconClassName:"",onClick:function(e){e.hide()}}]})).render().then(function(e){$(".modal-parent-cont").append(e.$el)}))})},{}],14:[function(e,t,n){"use strict";var o,a;o=jQuery,a=window.location.href,o("#layoutSidenav_nav .sb-sidenav a.nav-link").each(function(){this.href===a&&o(this).addClass("active")}),o("#sidebarToggle").on("click",function(e){e.preventDefault(),o("body").toggleClass("sb-sidenav-toggled")})},{}],15:[function(e,t,n){window.ACommon=window.ACommon||{};window.json=function(e){return JSON.parse(e)};window.log=function(e){return console.log(e),e};function o(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}window.escapeRegExp=o;window.replaceAll=function(e,t,n){return e.replace(new RegExp(o(t),"g"),n)};window.timeSince=function(e){var t=Math.floor((new Date-e)/1e3),e=t/31536e3;return 1<e?Math.floor(e)+" year(s)":1<(e=t/2592e3)?Math.floor(e)+" month(s)":1<(e=t/86400)?Math.floor(e)+" day(s)":1<(e=t/3600)?Math.floor(e)+" hour(s)":1<(e=t/60)?Math.floor(e)+" minute(s)":Math.floor(t)+" second(s)"};window.UUID_NIL="00000000-0000-0000-0000-000000000000",ACommon.getCookie=function(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),o=0;o<n.length;o++){for(var a=n[o];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return""},window.ACommon.sessionid=ACommon.getCookie("asession"),ACommon.EnumGenerator=function(e){for(var t in e)e.hasOwnProperty(t)&&(e[e[t]]=t);return e};var a,t=window||{};a={put:function(e,a,i,d){return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("PUT",e,!0),o.setRequestHeader("Content-type","application/json; charset=utf-8"),o.onload=function(){var e=o.responseText;4==o.readyState&&"200"==o.status?("function"==typeof i&&i(e),"function"==typeof t&&t(e)):("function"==typeof d&&d(e),"function"==typeof n&&n(e))},o.send(JSON.stringify(a))})},get:function(e,a,i){return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=function(){var e=o.responseText;4==o.readyState&&"200"==o.status?("function"==typeof a&&a(e),"function"==typeof t&&t(e)):("function"==typeof i&&i(e),"function"==typeof n&&n(e))},o.send(null)})},post:function(e,a,i,d){return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("POST",e,!0),o.setRequestHeader("Content-type","application/json; charset=utf-8"),o.onload=function(){var e=o.responseText;4==o.readyState&&"200"==o.status?("function"==typeof i&&i(e),"function"==typeof t&&t(e)):("function"==typeof d&&d(e),"function"==typeof n&&n(e))},o.send(JSON.stringify(a))})},delete:function(e,a,i,d){return new Promise(function(t,n){var o=new XMLHttpRequest;o.open("DELETE",e,!0),o.setRequestHeader("Content-type","application/json; charset=utf-8"),o.onload=function(){var e=o.responseText;4==o.readyState&&"200"==o.status?("function"==typeof i&&i(e),"function"==typeof t&&t(e)):("function"==typeof d&&d(e),"function"==typeof n&&n(e))},o.send(JSON.stringify(a))})}},t.Ajax=a},{}],16:[function(e,t,n){e("./browser");e=window.AEnvironment||{};(window.AEnvironment=e).CURRENTHOST_URL=location.protocol+"//"+location.host,e.EVENT_API_URL=e.API_URL+"/events/capture-it",e.CONTACT_US_API=e.API_URL+"/contact-us",e.NEWS_LETTER_API=e.API_URL+"/newsletter",e.REVIEW_API=e.API_URL+"/review",e.REVIEW_BY_API=e.API_URL+"/review/product/{{prodid}}",e.SESSION_END_URL=e.CURRENTHOST_URL+"/end-session",e.V_MAJOR=1,e.V_MINOR=5,e.V_PATH=2,e.VERSION="v"+e.V_MAJOR+"."+e.V_MINOR+"."+e.V_PATH},{"./browser":17}],17:[function(e,t,n){e("./ajax");var o,t=window||{};(o={}).isOpera=!!window.opr&&!!opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),o.isFirefox="undefined"!=typeof InstallTrigger,o.isSafari=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString(),o.isIE=!!document.documentMode,o.isEdge=!o.isIE&&!!window.StyleMedia,o.isChrome=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),o.isEdgeChromium=o.isChrome&&-1!=navigator.userAgent.indexOf("Edg"),o.isBlink=(o.isChrome||o.isOpera)&&!!window.CSS,o.getName=function(){return o.isEdgeChromium?"Edge with chrome engine":o.isEdge?"Edge":o.isOpera?"Opera":o.isFirefox?"Firefox":o.isSafari?"Safari":o.isIE?"IE":o.isChrome?"Chrome":"unknown"},t.ABrowser=o},{"./ajax":15}],18:[function(e,t,n){var o=function(e){null==e&&(e={}),null==e.rootpath&&(e.rootpath="/packages/bootstrap-modal");function o(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var t=0;window.escapeRegExp=o;function a(e,t,n){return e.replace(new RegExp(o(t),"g"),n)}window.replaceAll=a;var i=function(e){null==e&&(e={}),this.attrs={},Object.defineProperty(this,"body",{set:function(e){return this.attrs.body==e?this.attrs.body=e:(this.attrs.body=e,this.renderBody(),this.attrs.body)}.bind(this),get:function(){return this.attrs.body}.bind(this)}),Object.defineProperty(this,"headerText",{set:function(e){return this.attrs.headerText==e?this.attrs.headerText=e:(this.attrs.headerText=e,this.renderHeaderText(),this.attrs.headerText)}.bind(this),get:function(){return this.attrs.headerText}.bind(this)}),Object.defineProperty(this,"id",{set:function(e){return this.attrs.id==e?this.attrs.id=e:(this.attrs.id=e,this.attrs.id)}.bind(this),get:function(){return this.attrs.id}.bind(this)}),Object.defineProperty(this,"buttons",{set:function(e){return this.attrs.buttons==e?this.attrs.buttons=e:(this.attrs.buttons=e,this.renderBtns(),this.attrs.buttons)}.bind(this),get:function(){return this.attrs.buttons}.bind(this)}),Object.defineProperty(this,"formData",{set:function(e){return this.attrs.formData==e?this.attrs.formData=e:(this.attrs.formData=e,this.attrs.formData)}.bind(this),get:function(){return this.attrs.formData}.bind(this)}),Object.defineProperty(this,"size",{set:function(e){return this.attrs.size==e?this.attrs.size=e:(this.attrs.size=e,this.renderSize(),this.attrs.size)}.bind(this),get:function(){return this.attrs.size}.bind(this)}),Object.assign(this.attrs,i.defaults(),e),this.$el=this.attrs.$el};return i.prototype.renderSize=function(){var e=this.size;return this.$el.find(".modal-dialog").removeClass("modal-sm"),this.$el.find(".modal-dialog").removeClass("modal-lg"),e==i.SIZE.SMALL?this.$el.find(".modal-dialog").addClass("modal-sm"):e==i.SIZE.MEDIUM||e==i.SIZE.LARGE&&this.$el.find(".modal-dialog").addClass("modal-lg"),this},i.prototype.renderBody=function(){return this.$el.find(".parent-folder-para").html(this.body),this},i.prototype.renderHeaderText=function(){return this.$el.find(".modal-title").html(this.headerText),this},i.prototype.renderBtns=function(){for(var e=0;e<this.buttons.length;e++){var t=this.buttons[e],n=i.templates.button,n=a(n,"{{btnClassName}}",t.btnClassName);n=a(n,"{{btnType}}",t.btnType),n=a(n,"{{buttonId}}",t.buttonId),n=a(n,"{{label}}",t.label),n=a(n,"{{iconClassName}}",t.iconClassName);n=$(n);t.iconClassName||n.find(".custom-btn-icon").hide(),"function"==typeof t.onClick&&n.bind("click",function(e,t){e.onClick(this,t)}.bind(this,t)),this.$el.find(".modal-footer").append(n),this.$el.find(".modal-footer").append('<span class="btn-gap">&nbsp;</span>')}return this},i.prototype.render=function(){return new Promise(function(t,e){this.$el.html(""),this.$el.attr("id",this.id);var n=function(){var e=i.templates.main,e=a(e,"{{modalId}}",this.id);e=a(e,"{{modalHeader}}",this.headerText),e=a(e,"{{modalDesc}}",this.body),this.$el.html(e),this.renderBtns(),this.renderSize(),this.formData&&(e=new BForms.Model(this.formData),this.formView=new BForms.View({model:e}),this.$el.find(".form-container").append(this.formView.render().$el)),t(this)}.bind(this);i.templates.main&&i.templates.button?n():Promise.all([i.templateProms.main,i.templateProms.button]).then(n)}.bind(this))},i.prototype.show=function(){this.$el.find(".modal").modal("show")},i.prototype.hide=function(){this.$el.find(".modal").modal("hide")},i.templates={},i._saveTpl=function(e,t){return i.templates[e]=t,i.templates[e]},i.templateProms={main:Ajax.get(e.rootpath+"/templates/main.html").then(i._saveTpl.bind(i,"main")),button:Ajax.get(e.rootpath+"/templates/button.html").then(i._saveTpl.bind(i,"button"))},i.defaults=function(){return{id:"custom-modal-"+t++,buttons:[],$el:$('<div class="custom-modal"></div'),size:i.SIZE.MEDIUM}},i.SIZE={SMALL:0,MEDIUM:1,LARGE:2},i}(window.bmodalConfig||void 0);window.BModal=o},{}]},{},[10]);